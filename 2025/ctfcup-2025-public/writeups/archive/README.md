# Archive
## Базовый сценарий
Пользователь заходит и загружает некоторую библиотеку (sqlite база данных) содержащую книги (сериализованные объекты). Он может просматривать книги в бибилотеки указав её имя.

### Все фичи
- Загрузка библиотек
- Просмотр книг
- Смена текущей библиотеки

## Архитектура
Бинарь на С++ с использованием serialization из библиотеки boost.

## Уязвимости

CVE-2023-34399 в boost serialization. Книги сериализуются как указатель и десериалицуются точно также.
Смысл бага в том, что мы можем передать кастомную строку которая будет десериализовываться.

```
22 serialization::archive 18 -3083 1 1\n0 3 kek 3 pek 1777
```

Указывая отрицательный индекс мы будем манипулировать объектом который возьмётся из массива.

## Эксплуатация

Манипулируя хипой нам нужно сделать правильный феншуй и получить объект полностью контролируемый нами.

## Как фиксить

Несколько вариантов:
- переписать на Python, т.к. функционала практически нет
- Бинарно запатчить проверку индекса (проверять что он меньше нуля)

## Сплоит
Ищите в репозитории, в папке `/sploits/archive`.
