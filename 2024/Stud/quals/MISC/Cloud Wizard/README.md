# MCTF Task: Cloud Wizard

**Категории:** rev, crypto, forensics

### Описание

Стоило только на пару дней запустить наш новый сервер, как его уже кто-то атаковал.

Действительно ли в аббревиатуре APT есть слово Advanced? Мы считаем, что нет, ведь мы а ведь задумка была неплохая. 

### Сборка

Сборка в докере невозможна, т.к. используется DPAPI и шифрование на ключе, уникальном для Windows-системы.

Создание набора файлов осуществляется путем запуска скрипта `builder.py`. Внутри скрипта в бинарном виде  сразу вшиты нужные скомпилированные исполняемые файлы.

Скрипту передаются аргументы:
- `-o`,  `--output` - название файла полезной нагрузки
- `-f`, `--flag` - флаг, который нужно зашить в полезную нагрузку

Тестовый запуск производится с помощью запуска основного исполняемого файла:

```
dbgsrv.exe -t npipe:pipe=foobar
```

При этом файл полезной нагрузки должен лежать в директории `C:\ProgramData\Intel\Logs\%название файла полезной нагрузки%`

На машине, на которой осуществлялась сборка (`builder.py`) сразу будет выведено окно с флагом. На любой другой машине запуск не осуществится (из-за DPAPI).

**ВАЖНО**: не билдить набор файлов на виртуалках, которые команды могут использовать при решении задач.

### Writeup
см. в директорию solution

### Flag
```
MCTF{APTs_d0_n0t_us3_weak_3ncrypt1on}
```