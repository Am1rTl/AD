# oh no | Forensic | Medium 

## Описание 
RU: Я случайно удалил очень важный скрипт! Помоги мне его вернуть, пожалуйста, это уже не смешно :(

EN:

I accidentally deleted a very important script! Help me get it back, please, it’s not funny anymore :(

[Link](https://mega.nz/file/piMU0ZhC#Nr7KzwtKmb6WpLAaOUP7dtMS3ekoBWgB2Afm7ideOl0)

## Решение 

Нам  дан файл жесткого диска для виртуальной машины (.vdi). Из описания таска понятно, что был удален некий скрипт, который нам нужно восстановить.

Для восстановления удаленных файлов можно воспользоваться autopsy. Проблема в том, что autopsy не сможет переварить vdi файл и нам его надо переконвертировать. Для этого мы создадим новую виртуалку, зададим ей данный нам диск и уже с помощью встроенной в VirtualBox утилиты VBoxManage проведем конвертацию в читаемый для autopsy формат.

![](https://i.ibb.co/HP93WW7/writeup1.jpg)

На выходе получаем дамп жесткого диска размером ~30 гб, который сможет прочитать autopsy. Зальем его туда и найдем удаленный скрипт. Стоит держать в голове что мы работаем с windows, вероятнее всего скрипт написан на powershell и имеет расширение .ps1

![](https://i.ibb.co/V2WsKCz/writeup2.jpg)

Найдя нужный нам скрипт нам необходимо понять логику его работы. С определенной ссылки мы забираем байты картинки, ищем флаг BASE64_START, забираем байты до флага BASE64_FINISH, переворачиваем и переводим из base64. Сам скрипт имеет сомнительную работоспособность, поэтому нам необходимо вытащить интересующую нас информацию самим. Переходим по [ссылке](https://i.ibb.co/BNPFNdv/Wf3-Zjja-C35.jpg) и скачиваем нашу картинку. Смотрим в hex и видим интересующую нас строчку.

![](https://i.ibb.co/KV1Lgyf/writeup3.jpg)

Переворачиваем строчку, переводим из base64 и получаем флаг.

![](https://i.ibb.co/vDVnTp1/writeup4.jpg)

## Flag
```
mctf{0h_no_My_Pow3rSh3l1_sCr1pt_c011eCti0n}
```